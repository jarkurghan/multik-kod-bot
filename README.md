# multik-kod-bot

Bot ‚Äî grammy (typeScript) va supabase texnologiyalari asosida yaratilgan telegram bot.
Botning asosiy vazifasi foydalanuvchilarga maxsus kodlar orqali (kino yoki) multfilmlarni topish va jo'natishdir.

Shuningdek, bot foydalanuvchilar statistikasini yuritadi va yangi qo'shilganlar haqida adminga xabar beradi.

> Botdan o'z botingiz sifatida foydalanish uchun, o'z ma'lumotlar omboringiz (database), o'z botingiz va o'z kino yoki multfilm yig'ilgan kanalingiz kerak!

---

## üöÄ Imkoniyatlari

-   **Kod orqali qidiruv**  
    Foydalanuvchi `M...` formatidagi kodni yuboradi (masalan, `M123`) va bot bazadan mos keluvchi multfilmni topib beradi.

-   **Deep Linking**  
    `t.me/uz_multfilm_bot?start=mcode...` havolasi orqali kirilganda to‚Äòg‚Äòridan-to‚Äòg‚Äòri multfilm taqdim etiladi.

-   **Foydalanuvchilar bazasi**  
    Har bir foydalanuvchi ma‚Äôlumotlari (ID, username, ism) Supabase bazasida saqlanadi.

-   **Admin xabarnomasi**  
    Yangi foydalanuvchi kirganda, adminga ma‚Äôlumot yuboriladi.

-   **UTM Tracking**  
    Foydalanuvchi qaysi manbadan kelganligini kuzatish imkoniyati.

---

## üõ† Texnologiyalar

-   **Runtime:** Bun / Node.js / Deno / Cloudflare Workers (Hono adapteri)
-   **Framework:** grammY (Telegram Bot API)
-   **Database:** Supabase (PostgreSQL)
-   **Language:** TypeScript

---

## ‚öôÔ∏è O‚Äòrnatish va Ishlatish (Local Development)

### 1. Talablar

Quyidagilar o‚Äòrnatilgan bo‚Äòlishi kerak:

-   Node.js (v16 yoki yuqori)
-   bun yoki npm

### 2. Loyihani yuklab olish

```bash
git clone https://github.com/jarkurghan/multik-kod-bot.git
cd multik-kod-bot
```

### 3. Kutubxonalarni o‚Äòrnatish

```bash
bun install
```

### 4. Environment Variables sozlash

Loyiha papkasida `.env` fayl yarating va quyidagilarni kiriting
(`src/constants.ts` bilan mos bo‚Äòlishi kerak):

```env
BOT_TOKEN=bot_token
SUPABASE_URL=supabase_url
SUPABASE_KEY=supabase_key
ADMIN_CHAT=admin_telegram_id
CHANNEL=baza_channel
TABLE_NAME=movies
USER_TABLE_NAME=users
```

### 5. Supabase Bazasi Tuzilishi

#### users jadvali

```sql
create table users (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  tg_id bigint unique,
  first_name text,
  last_name text,
  username text,

  unique (tg_id)
);
```

#### movies jadvali

```sql
create table movies (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  code text unique,
  posts text -- Masalan: 123,124
);
```

### 6. Botni ishga tushirish

```bash
bun dev
```

---

## ü§ù Hissa Qo‚Äòshish

1. Reponi **Fork** qiling
2. Yangi branch yarating
    ```bash
    git checkout -b feature/yangi-branch-nomi
    ```
3. O‚Äòzgarishlarni commit qiling
    ```bash
    git commit -m "Yangi imkoniyat haqida batafsil"
    ```
4. Branchni push qiling va Pull Request yuboring

---

## Litsenziya

MIT License ‚Äî istalgan o'zgartirish va foydalanish uchun ochiq.

**Muallif:** [@jarkurghan](https://t.me/najmiddin_nazirov)
